<div class="col s12 m4">
	<div class="card medium hoverable">
		<div class="card-image">
			<%= link_to shop_path(shop.id), class: "waves-effect waves-light" do %>
				<%= image_tag shop_for(shop) %>
				<span class="card-title"><%= shop.name %></span>
			<% end %>
		</div>
		<div class="card-content">
			<div id="favorite-shop-<%= shop.id.to_s %>">
				<% if user_signed_in? %>
					<% if !Favorite.exists?(user_id: current_user.id, shop_id: shop.id) %>
						<%= link_to '', shop_favorite_path(shop), method: :post, remote: true, class: "unlike" %>
					<% else %>
						<%= link_to '', shop_favorite_path(shop), method: :delete, remote: true, class: "like" %>
					<% end %>
				<% else %>
					<div class="unfavorite"></div>
				<% end %>
			</div>
			<p class="star-rate" id="star-rate-<%= shop.id %>"></p>&nbsp<%= shop.rate_average %>
			<i class="far fa-comments"></i>&nbsp<%= shop.comments.size %>ä»¶
		</div>
	</div>
</div>
<script>
  $(document).ready(function(){
		$('#star-rate-<%= shop.id %>').raty({
			size: 36,
			starOff: '/images/star_off.png',
			starOn: '/images/star_on.png',
			starHalf: '/images/star_half.png',
			score: '<%= shop.comments.average(:rate) %>',
			half: true,
			readOnly: true,
		});
	});
</script>
