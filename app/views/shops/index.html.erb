<div class="mt-3">
	<ul class="nav nav-tabs" id="myTab" role="tablist">
		<li class="nav-item">
			<a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">お店の名前で検索する</a>
		</li>
		<li class="nav-item">
			<a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">お店の場所で検索する</a>
		</li>
	</ul>
	<div class="tab-content mt-3" id="myTabContent">
		<div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
			<%= search_form_for @q, class: 'mb-5' do |f| %>
				<div class="form-group row">
					<div class="col-sm-10">
						<%= f.search_field :name_cont, class: "form-control" %>
					</div>
				</div>
				<div class="form-group">
					<%= f.submit class: "btn btn-outline-primary" %>
				</div>
			<% end %>
		</div>
		<div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
			<%= search_form_for @q do |f| %>
				<div class="form-group row">
					<div class="col-sm-10">
						<%= f.search_field :address_cont, class: "form-control" %>
					</div>
				</div>
				<div class="form-group">
					<%= f.submit class: "btn btn-outline-primary" %>
				</div>
			<% end %>
		</div>
		<div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">...</div>
	</div>
</div>

<% if current_user&.admin? %>
	<div>
		<%= link_to '新規登録', new_shop_path, class: 'btn btn-primary' %>
	</div>
<% end %>

<div class="mt-3">
	<%= paginate @shops %>
	<%= page_entries_info @shops, entry_name: '店舗' %>
</div>

<div class="card-columns mt-3">
	<% @shops.each do |shop| %>
		<div class="col mb-4">
			<div class="card h-100">
				<%= link_to shop_path(shop.id) do %>
					<%= image_tag shop.image, class: 'card-img-top', width: "100%", height: "180" if shop.image.attached? %>
				<% end %>
				<div class="card-body">
					<h5 class="card-title font-weight-bold"><%= shop.name.truncate(20, omission: '...') %></h5>
					<p class="card-text">
						<% if (status = shop.comments.average(:status).to_f.round(1)) >= 2.0 then %>
							<p style="color: #BE4BDB"><i class="far fa-dizzy"></i>混んでいた</p>
						<% elsif status >= 1.0 then %>
							<p style="color: #82c91e"><i class="far fa-smile"></i>普通だった</p>
						<% else %>
							<p style="color: #F783AC"><i class="far fa-laugh"></i>空いていた</p>
						<% end %>
					</p>
					<p class="card-text"><small class="text-muted"><%= shop.updated_at.strftime("%Y年%-m月%-d日 更新") %></small></p>
					<% if current_user&.admin? %>
						<div class="mt-3">
							<%= link_to '編集', edit_shop_path(shop.id), class: "btn btn-primary mr-3" %>
							<%= link_to '削除', shop_path(shop.id), method: :delete, data: { confirm: "「#{shop.name}」を削除します。よろしいですか？" }, class: "btn btn-danger" %>
						</div>
					<% end %>
				</div>
			</div>
		</div>
	<% end %>
